#!/bin/bash
# Test specific phase modules
set -euo pipefail

PHASE=${1:-"all"}

echo "üß™ Testing Phase $PHASE modules..."

case $PHASE in
    "1"|"phase1")
        echo "Testing Phase 1: Core Foundation Modules"
        echo "  - role-management"
        echo "  - trade-teams" 
        echo "  - volunteer-management"
        
        # Check if modules exist and have basic structure
        for module in role-management trade-teams volunteer-management; do
            if [ -d "lib/$module" ]; then
                echo "‚úÖ $module: Structure exists"
                if [ -f "lib/$module/src/index.ts" ]; then
                    echo "‚úÖ $module: TypeScript entry point found"
                fi
                if [ -f "lib/$module/src/api.ts" ]; then
                    echo "‚úÖ $module: API implementation found"
                fi
                if [ -f "lib/$module/src/components.tsx" ]; then
                    echo "‚úÖ $module: React components found"
                fi
            else
                echo "‚ùå $module: Module not found"
            fi
        done
        ;;
        
    "2"|"phase2")
        echo "Testing Phase 2: Workflow and Scheduling Modules"
        echo "  - assignment-workflow"
        echo "  - calendar-scheduling"
        
        for module in assignment-workflow calendar-scheduling; do
            if [ -d "lib/$module" ]; then
                echo "‚úÖ $module: Structure exists"
                if [ -f "lib/$module/contracts/openapi.yaml" ]; then
                    echo "‚úÖ $module: OpenAPI contract found"
                fi
                if [ -f "lib/$module/src/workflow-engine.ts" ] || [ -f "lib/$module/src/calendar-engine.ts" ]; then
                    echo "‚úÖ $module: Business logic engine found"
                fi
            else
                echo "‚ùå $module: Module not found"
            fi
        done
        ;;
        
    "3"|"phase3")
        echo "Testing Phase 3: Communication and Coordination Modules"
        echo "  - communication-hub"
        echo "  - project-coordination"
        
        for module in communication-hub project-coordination; do
            if [ -d "lib/$module" ]; then
                echo "‚úÖ $module: Structure exists"
            else
                echo "‚ùå $module: Module not found"
            fi
        done
        ;;
        
    "all")
        echo "Testing all phases..."
        $0 1
        echo ""
        $0 2
        echo ""
        $0 3
        ;;
        
    *)
        echo "‚ùå Unknown phase: $PHASE"
        echo "Usage: $0 [1|2|3|all]"
        exit 1
        ;;
esac

echo ""
echo "üìä Phase $PHASE testing complete!"
